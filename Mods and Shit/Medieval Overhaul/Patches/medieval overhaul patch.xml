<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <!-- Smoker no rustic furn please! -->
  <Operation Class="PatchOperationReplace">
    <success>Always</success>
    <xpath>Defs/ThingDef[defName="DankPyon_Smoker"]/researchPrerequisites</xpath>
    <value>
      <researchPrerequisites>
        <li>DankPyon_Smoker</li>
      </researchPrerequisites>
    </value>
  </Operation>
  <!--Grain and bread is the basis of human civilization-->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="DankPyon_Oven"]/techLevel</xpath>
    <value>
      <techLevel>Neolithic</techLevel>
    </value>
  </Operation>
  <!-- Rusting cooking table -->
  <Operation Class="PatchOperationConditional">
    <success>Always</success>
    <xpath>/Defs/ThingDef[defName="DankPyon_RusticCookingTable"]/researchPrerequisites</xpath>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="DankPyon_RusticCookingTable"]/researchPrerequisites</xpath>
          <value>
            <researchPrerequisites>
              <li>DankPyon_BasicCooking</li>
            </researchPrerequisites>
          </value>
        </li>
      </operations>
    </match>
    <nomatch Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationAdd">
          <xpath>/Defs/ThingDef[defName="DankPyon_RusticCookingTable"]</xpath>
          <value>
            <researchPrerequisites>
              <li>DankPyon_BasicCooking</li>
            </researchPrerequisites>
          </value>
        </li>
      </operations>
    </nomatch>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <success>Always</success>
    <xpath>Defs/ThingDef[defName="DankPyon_RusticCookingTable"]/label</xpath>
    <value>
      <label>basic cooking table</label>
    </value>
  </Operation>
  <!-- VE COOKING OVERLAP -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Vanilla Cooking Expanded</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="VCE_MakeSalt"]</xpath>
        </li>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="VCE_MakeSaltfromBlocks"]</xpath>
        </li>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/ResearchProjectDef[defName="VCE_CheeseMaking"]</xpath>
        </li>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/ThingDef[defName="VCE_CheesePress"]/researchPrerequisites</xpath>
        </li>
        <!-- <li Class="PatchOperationReplace">
                    <success>Always</success>
                    <xpath>Defs/ThingDef[defName="VCE_CheesePress"]/label</xpath>
                                <value>
                                    <label>This is not supposed to be here</label>
                                </value>
                </li> -->
        <li Class="PatchOperationAdd">
          <xpath>/Defs</xpath>
          <value>
            <ReplaceLib.ReplacerDef>
              <defName>ProgKitchen_MedievalOverhaul_VECooking</defName>
              <replacers>
                <li>
                  <replace>VCE_Salt</replace>
                  <with>DankPyon_Salt</with>
                </li>
                <li>
                  <replace>VCE_Cheese</replace>
                  <with>DankPyon_MealCheese</with>
                </li>
                <li>
                  <replace>VCE_CheesePress</replace>
                  <with>DankPyon_Presser</with>
                </li>
                <li>
                  <replace>VCE_Flour</replace>
                  <with>DankPyon_Flour</with>
                </li>
                <li>
                  <replace>VCE_RawSpices</replace>
                  <with>DankPyon_Spices</with>
                </li>
                <li>
                  <replace>VCE_RawSugar</replace>
                  <with>DankPyon_Sugar</with>
                </li>
              </replacers>
            </ReplaceLib.ReplacerDef>
          </value>
        </li>
        <!-- SEARING STUFF -->
        <!-- <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/ResearchProjectDef[defName="DankPyon_Grill"]/label</xpath>
          <value>
            <label>searing</label>
          </value>
        </li> -->
        <!-- <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/ResearchProjectDef[defName="DankPyon_Grill"]/description</xpath>
          <value>
            <description>Learn how to sear meat over an open flame, creating delicious seared sausages and meats.</description>
          </value>
        </li> -->
        <!-- <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/ThingDef[defName="DankPyon_Grill"]/label</xpath>
          <value>
            <label>searing brazier</label>
          </value>
        </li> -->
        <!-- <li Class="PatchOperationReplace">
          <xpath>/Defs/RecipeDef[contains(defName, "VCE_CookGrillFine")]/researchPrerequisites</xpath>
          <value>
            <researchPrerequisites>
              <li>VCE_Grilling</li>
            </researchPrerequisites>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/RecipeDef[starts-with(defName, "VCE_CookGrillLavish")]/researchPrerequisites</xpath>
          <value>
            <researchPrerequisites>
              <li>VCE_Grilling</li>
            </researchPrerequisites>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/RecipeDef[defName="VCE_CookGrillGourmet"]/researchPrerequisites</xpath>
          <value>
            <researchPrerequisites>
              <li>VCE_Grilling</li>
            </researchPrerequisites>
          </value>
        </li> -->
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/ThingDef[defName="DankPyon_MealGrilledSausages"]/label</xpath>
          <value>
            <label>seared sausages</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_MealGrilledSausages"]/label</xpath>
          <value>
            <label>seared sausages</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_MealGrilledCheese"]/label</xpath>
          <value>
            <label>seared cheese</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_MealGrilledSkewers"]/label</xpath>
          <value>
            <label>seared skewers</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausages"]/label</xpath>
          <value>
            <label>sear sausages</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausages"]/description</xpath>
          <value>
            <description>Sear a straightforward meal from sausages.</description>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausages"]/jobString</xpath>
          <value>
            <jobString>Searing sausages.</jobString>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausagesBulk"]/label</xpath>
          <value>
            <label>sear sausages x5</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausagesBulk"]/description</xpath>
          <value>
            <description>Sear a straightforward meal from sausages in bulk.</description>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausagesBulk"]/jobString</xpath>
          <value>
            <jobString>Searing 5 sausages.</jobString>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/ThingDef[defName="DankPyon_MealGrilledCheese"]/label</xpath>
          <value>
            <label>seared cheese</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledCheese"]/label</xpath>
          <value>
            <label>sear cheese</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledCheese"]/description</xpath>
          <value>
            <description>Sear cheese into a delicious meal.</description>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledCheese"]/jobString</xpath>
          <value>
            <jobString>Searing cheese.</jobString>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledCheeseBulk"]/label</xpath>
          <value>
            <label>sear cheese x5</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledCheeseBulk"]/description</xpath>
          <value>
            <jobString>Sear cheese in bulk into delicious meals.</jobString>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledCheeseBulk"]/jobString</xpath>
          <value>
            <jobString>Searing cheese.</jobString>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/ThingDef[defName="DankPyon_MealGrilledCheese"]/label</xpath>
          <value>
            <label>seared cheese</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/ThingDef[defName="DankPyon_MealGrilledSkewers"]/label</xpath>
          <value>
            <label>seared skewers</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSkewers"]/label</xpath>
          <value>
            <label>sear skewers</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausages"]/description</xpath>
          <value>
            <description>Sear a delicious meal from meat.</description>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSausages"]/jobString</xpath>
          <value>
            <jobString>Searing skewers.</jobString>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSkewersBulk"]/label</xpath>
          <value>
            <label>sear skewers x5</label>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSkewersBulk"]/description</xpath>
          <value>
            <description>Sear delicious meals from meat in bulk.</description>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/RecipeDef[defName="DankPyon_CookMealGrilledSkewersBulk"]/jobString</xpath>
          <value>
            <jobString>Searing 5 skewers.</jobString>
          </value>
        </li>
        <!-- Move condiments to MO's condiments to VC condiments category -->
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="DankPyon_Salt"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>VCE_Condiments</li>
            </thingCategories>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="DankPyon_Spices"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>VCE_Condiments</li>
            </thingCategories>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="DankPyon_Sugar"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>VCE_Condiments</li>
            </thingCategories>
          </value>
        </li>
      </operations>
    </match>
  </Operation>

  <!-- ALPHA ANIMALS MILK CATEGORIES -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Alpha Animals</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="AA_NightMilk" or
            defName="AA_BlueMilk" or
            defName="AA_GowMilk"
            ]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
      </operations>
    </match>
  </Operation>
  <!-- VE GENETICS MILK CATEGORIES -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Vanilla Genetics Expanded</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="GR_WeirdMilk" or
            defName="GR_MechaMilk" or
            defName="GR_BearffaloMilk" or
            defName="GR_ThrumffaloMilk" or
            defName="GR_MuffalochickenMilk" or
            defName="GR_ChickenffaloMilk" or
            defName="GR_MuffalobearMilk" or
            defName="GR_WolffaloMilk" or
            defName="GR_RatMilk"
            ]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
        <li Class="PatchOperationFindMod">
          <mods>
            <li>Megafauna</li>
          </mods>
          <match Class="PatchOperationSequence">
            <operations>
              <li Class="PatchOperationReplace">
                <xpath>/Defs/ThingDef[defName="GR_ParaMilk" or
                  defName="GR_GreenMilk"
                  ]/thingCategories</xpath>
                <value>
                  <thingCategories>
                    <li>DankPyon_Milk</li>
                  </thingCategories>
                </value>
              </li>
            </operations>
          </match>
        </li>
      </operations>
    </match>
  </Operation>
  <!-- Megafauna -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Megafauna</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="SivatheriumMilk"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
      </operations>
    </match>
  </Operation>
  <!-- Dark Ages : Beasts and Monsters -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Dark Ages : Beasts and Monsters</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="DA_RegalMilk"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="DA_MufftonMilk"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
      </operations>
    </match>
  </Operation>
  <!-- Mythic Ages: Megafauna Bestiary -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Mythic Ages: Megafauna Bestiary</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="MA_MossmireMilk"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="MA_DuskMilk"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
      </operations>
    </match>
  </Operation>
  <!-- Royal Thrumbos (Continued) -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Royal Thrumbos (Continued)</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <li Class="PatchOperationReplace">
          <xpath>/Defs/ThingDef[defName="RoyalThrumbo_Milk"]/thingCategories</xpath>
          <value>
            <thingCategories>
              <li>DankPyon_Milk</li>
            </thingCategories>
          </value>
        </li>
      </operations>
    </match>
  </Operation>
  <!-- Add baked MO baked items to electric stove -->
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/RecipeDef[defName="DankPyon_BakeBread" or
      defName="DankPyon_CookMealApplePie" or
      defName="DankPyon_CookMealLemonCake" or
      defName="DankPyon_CookMealQuiche" or
      defName="DankPyon_CookMealPumpkinPie" or
      defName="DankPyon_CookMealCarrotCake" or
      defName="DankPyon_CookMealGriffonBerryPie"
      ]/recipeUsers</xpath>
    <order>Append</order>
    <value>
      <li>ElectricStove</li>
    </value>
  </Operation>
  <!-- Fix carrot cake description and jobString -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealCarrotCake"]/description</xpath>
    <value>
      <description>Bake 3 carrot cakes.</description>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealCarrotCake"]/jobString</xpath>
    <value>
      <jobString>Baking 3 carrot cakes.</jobString>
    </value>
  </Operation>
  <!-- Fix vegetarian meal rations -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealRationsVegan" or
      defName="DankPyon_CookMealRationsVeganBulk"
      ]/recipeUsers</xpath>
    <value>
      <recipeUsers>
        <li>Campfire</li>
        <li>FueledStove</li>
        <li>ElectricStove</li>
      </recipeUsers>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealRationsVegan"]/description</xpath>
    <value>
      <description>Prepare a vegetarian packaged ration from plant ingredients. Much of the ingredients are wasted in the preservation process.</description>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealRationsVegan"]/ingredients</xpath>
    <value>
      <ingredients>
        <li>
          <filter>
            <customSummary>vegetarian ingredients</customSummary>
            <categories>
              <li>PlantFoodRaw</li>
              <li>AnimalProductRaw</li>
            </categories>
          </filter>
          <count>0.85</count>
        </li>
      </ingredients>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealRationsVeganBulk"]/description</xpath>
    <value>
      <description>Prepare vegetarian packaged rations from plant ingredients. Much of the ingredients are wasted in the preservation process.</description>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealRationsVeganBulk"]/ingredients</xpath>
    <value>
      <ingredients>
        <li>
          <filter>
            <customSummary>vegetarian ingredients</customSummary>
            <categories>
              <li>PlantFoodRaw</li>
              <li>AnimalProductRaw</li>
            </categories>
          </filter>
          <count>4.25</count>
        </li>
      </ingredients>
    </value>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/RecipeDef[defName="DankPyon_CookMealRationsVeganBulkier"]</xpath>
  </Operation>


  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="DankPyon_Honeycomb"]/thingCategories</xpath>
    <value>
      <thingCategories>
        <li>DankPyon_Honey</li>
      </thingCategories>
    </value>
  </Operation>

  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="DankPyon_Sugarcane"]/thingCategories</xpath>
    <value>
      <thingCategories>
        <li>PlantMatter</li>
      </thingCategories>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="DankPyon_Sugarcane"]/ingestible</xpath>
    <value>
      <ingestible>
        <preferability>DesperateOnly</preferability>
        <canAutoSelectAsFoodForCaravan>false</canAutoSelectAsFoodForCaravan>
      </ingestible>
    </value>
  </Operation>


  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="DankPyon_RawHerb"]/thingCategories</xpath>
    <value>
      <thingCategories>
        <li>PlantMatter</li>
      </thingCategories>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="DankPyon_RawHerb"]/ingestible</xpath>
    <value>
      <ingestible>
        <preferability>DesperateOnly</preferability>
        <canAutoSelectAsFoodForCaravan>false</canAutoSelectAsFoodForCaravan>
      </ingestible>
    </value>
  </Operation>
  <!-- MO research projects requiring schematics are really hard to get if no MO factions are spawned! -->
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/TraderKindDef[defName="Orbital_Exotic"]/stockGenerators</xpath>
    <value>
      <li Class="StockGenerator_MarketValue">
        <tradeTag>DankPyon_Schematic</tradeTag>
        <countRange>1~1</countRange>
      </li>
    </value>
  </Operation>
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/TraderKindDef[defName="Caravan_Outlander_Exotic"]/stockGenerators</xpath>
    <value>
      <li Class="StockGenerator_MarketValue">
        <tradeTag>DankPyon_Schematic</tradeTag>
        <countRange>1~1</countRange>
      </li>
    </value>
  </Operation>
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ResearchProjectDef[defName="DankPyon_IntermediateCooking"]</xpath>
    <value>
      <tags>
        <li>ClassicStart</li>
      </tags>
    </value>
  </Operation>
</Patch>